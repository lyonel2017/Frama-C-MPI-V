module MPI_the_protocol

use protocol.MPI_Protocol
use int.Int
use int.EuclideanDivision


let constant the_protocol : protocol = 
  (Seq (Broadcast 0 1 MPI_int) 
  (Seq (Foreach 1 (size-1) (fun i -> Message 0 i 1000000 0 MPI_float))
  (Seq (Foreach 1 (size-1) (fun i -> Message 0 i 1000000 0 MPI_float))
  (Seq (Allreduce 1 MPI_float MPI_sum)
       (Foreach 1 (size-1) (fun i -> Message i 0 1 0 MPI_float))))))
end
