/**
 * An example protocol for a program that solves solves a Ax = b linear equation
 * using Jacobi’s method.
 *
 * Adapted from:
 *  "Parallel Programming with MPI" by Peter Pacheco, Morgan Kaufmann, 1997.
 *   parallel_jacobi.c example, Chap. 10, p. 220
 *
 * Authors: César Santos and Eduardo Marques
 * Version: $Id: parallel_jacobi.prot 4644 2015-06-09 14:55:33Z edrdo $
 * ParTypes - http://gloss.di.fc.ul.pt/ParTypes
 */
protocol parallel_jacobi {
//  val n : {y: integer | y > 0 and y % size = 0}
  val n : {y: integer | y > 0 and y % size = 0 and (y*y) % size = 0}
  val maxIter : integer
  scatter 0 float[n*n]
  scatter 0 float[n]
  allgather float[n/size]
  foreach i:1 .. maxIter {
    allgather float[n/size]
  }
  gather 0 float[n/size]
}